<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.104.2">
  <title>Arska Power Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <!--
  <link href="css/bootstrap.min.css" rel="stylesheet">
  -->
  <!--
  <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/dashboard/">
  
  -->

  <!--
  <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />

  -->

  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }

    .b-example-divider {
      height: 3rem;
      background-color: rgba(0, 0, 0, .1);
      border: solid rgba(0, 0, 0, .15);
      border-width: 1px 0;
      box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
    }

    .b-example-vr {
      flex-shrink: 0;
      width: 1.5rem;
      height: 100vh;
    }

    .bi {
      vertical-align: -.125em;
      fill: currentColor;
    }

    .nav-scroller {
      position: relative;
      z-index: 2;
      height: 2.75rem;
      overflow-y: hidden;
    }

    .nav-scroller .nav {
      display: flex;
      flex-wrap: nowrap;
      padding-bottom: 1rem;
      margin-top: -1px;
      overflow-x: auto;
      text-align: center;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }

    /* file upload button */
    input[type=file]::file-selector-button {
      margin-right: 20px;
      border: none;
      background: #00b595;
      padding: 10px 20px;
      border-radius: 0.375rem;
      color: #fff;
      cursor: pointer;
      transition: background .2s ease-in-out;
      width: 140px;
      display: block;
      line-height: 1.1;
    }

    input[type=file]::file-selector-button:hover {
      background: #029378;
    }
  </style>
  <!-- Custom styles for this template -->
  <link href="/css/dashboard.css" rel="stylesheet">
  <!--fonts-->
  <link rel="stylesheet" href="https://use.typekit.net/uwx3oza.css">
  <style>
    /* Chart.js */
    @keyframes chartjs-render-animation {
      from {
        opacity: .99
      }

      to {
        opacity: 1
      }
    }

    .chartjs-render-monitor {
      animation: chartjs-render-animation 1ms
    }

    .chartjs-size-monitor,
    .chartjs-size-monitor-expand,
    .chartjs-size-monitor-shrink {
      position: absolute;
      direction: ltr;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
      pointer-events: none;
      visibility: hidden;
      z-index: -1
    }

    .chartjs-size-monitor-expand>div {
      position: absolute;
      width: 1000000px;
      height: 1000000px;
      left: 0;
      top: 0
    }

    .chartjs-size-monitor-shrink>div {
      position: absolute;
      width: 200%;
      height: 200%;
      left: 0;
      top: 0
    }
  </style>
</head>

<body>
  <script src="js/jquery-3.6.0.min.js">
  </script>
  <script>
    // load arska-ui.js with version number in the query string
    var version_a = $.ajax({ type: "GET", url: "/data/version.txt?rnd="+(Math.floor(Math.random() * 100)), async: false }).responseText.split(' ');
    let version = version_a[0];
    console.log("Arska  version", version);
    script = document.createElement("script");
    script.src = "js/arska-ui.js?" + version;
    document.getElementsByTagName("body")[0].appendChild(script);
  </script>
  <!-- <script src="js/arska-ui.js"></script> -->
  <!--<script src="js/chart.min.3.9.1.js"></script>-->


  <!-- Header
================================================== -->

  <header>
    <!-- Mobile header
================================================== -->

    <div class="mobile-header d-md-none py-1 d-flex align-items-center">
      <a class="mobile-menu-btn mx-2" data-bs-toggle="offcanvas" href="#mobileMenu" role="button"
        aria-controls="mobileMenu">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
          class="mobile-menu-icon bi bi-list" viewBox="0 0 16 16">
          <path fill-rule="evenodd"
            d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
        </svg>
      </a>
      <a class="brand-logo logotext mx-auto" href="#"><span class="logotext me-4">arska</span></a>
    </div>

    <!--    mobiilimenu
================================================== -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileMenu" aria-labelledby="mobileMenu">
      <div class="offcanvas-header px-4 pb-0">
        <h5 class="offcanvas-title" id="mobileMenuLabel">Valikko</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div>
          <ul class="mobile-menu">
            <li class="menu-item active"><a href="#">Dashboard</a></li>
            <li class="menu-item"><a href="#">Channels</a></li>
            <li class="menu-item"><a href="#">Settings</a></li>
            <li class="menu-item"><a href="#">Arska Wiki</a></li>
          </ul>
        </div>
      </div>
    </div>

    <!--Desktop header
================================================== -->

    <div class="container-xl p-3 d-none d-md-block sticky-top">
      <div class="d-flex align-items-center justify-content-between">
        <a class="brand-logo logotext" href="#"><span class="logotext">arska</span></a>

        <!-- Desktop Menu
================================================== -->
        <ul class="nav nav-pills app-menu" id="pills-tab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="dashboard-tab" data-bs-toggle="pill" data-bs-target="#dashboard"
              type="button" role="tab" aria-controls="dashboard" aria-selected="true">Dashboard</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="channels-tab" data-bs-toggle="pill" data-bs-target="#channels" type="button"
              role="tab" aria-controls="channels" aria-selected="false">Channels</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="admin-tab" data-bs-toggle="pill" data-bs-target="#admin" type="button"
              role="tab" aria-controls="admin" aria-selected="false">Settings</button>
          </li>
          <li class="nav-item" role="presentation">
            <a class="nav-link" href="https://github.com/Netgalleria/arska-node/wiki" target="_blank"><svg
                xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg"
                viewBox="0 0 16 16">
                <path
                  d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z" />
                <path
                  d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z" />
              </svg>Arska Wiki</a>
          </li>
        </ul>
      </div>
    </div>


  </header>



  <div class="container-xl p-0">
    <div class="row justify-content-center">

      <main class="mb-3 p-md-3">


        <!-- Tab content
================================================== -->
        <div class="tab-content p-0" id="arska-content">

          <!-- Dashboard
================================================== -->
          <div class="tab-pane fade show active" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab"
            tabindex="0">
            <div class="row g-4">
              <div class="col">
                <div class="card white-card p-3 px-xl-5 py-xl-4">
                  <div class="card-header">
                    <div class="chartjs-size-monitor">
                      <div class="chartjs-size-monitor-expand">
                        <div class=""></div>
                      </div>
                      <div class="chartjs-size-monitor-shrink">
                        <div class=""></div>
                      </div>
                    </div>
                    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center ">
                      <!--<h1 class="h2 card-title">Dashboard</h1>-->
                      <!--dashboard-nav-->
                      <!--
                      <nav class="nav nav-pills nav-fill">
                        <a class="nav-link active" aria-current="page" href="#">Active</a>
                        <a class="nav-link" href="#">Link</a>
                        <a class="nav-link" href="#">Link</a>
                        <a class="nav-link disabled">Disabled</a>
                      </nav>
                    -->
                    </div>
                    <!--
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span id="chart_title" class="chart-text">Day-ahead prices </span>
                      <span id="chart_subtitle" class="text-muted">29.01.2023 (00:00) &mdash; 31.01.2023 (01:00)</span>
                    </div>
                    -->
                    <!--./chart-info-->
                  </div>
                  <!--./card-header-->


                  <div class="form-section">

                    <div class="row g-3">
                      <h6 class="form-section-title">CURRENT PERIOD <span id="db:current_period"
                          class="text-muted"></span></h6>
                    </div>

                    <div class="row g-3">

                      <div id="db:export_d" class="col" data-bs-toggle="tooltip" data-bs-placement="top"
                        data-bs-custom-class="custom-tooltip"
                        data-bs-title="&uarr; Selling / &darr; buying, period average">
                        <span data-feather="arrow-up" style="pointer-events: none;" class="align-text-bottom"></span>
                        <span id="db:export_v"></span>

                      </div>
                      <div id="db:production_d" class="col" data-bs-toggle="tooltip" data-bs-placement="top"
                        data-bs-custom-class="custom-tooltip" data-bs-title="Production, period average">
                        <span data-feather="sun" style="pointer-events: none;" class="align-text-bottom"></span>
                        <span id="db:production_v"></span>
                        <span id="db:production_period" class="text-muted"></span>
                      </div>
                      <div id="db:price_d" class="col" data-bs-toggle="tooltip" data-bs-placement="top"
                        data-bs-custom-class="custom-tooltip" data-bs-title="Current market price">
                        <span data-feather="activity" style="pointer-events: none;" class="align-text-bottom"></span>
                        <span id="db:price_v"></span> <span id="db:price_period" class="text-muted"></span>
                      </div>

                      <div id="db:s_201:div" class="col" style="display: none;">
                        <span data-feather="thermometer" style="pointer-events: none;" class="align-text-bottom"></span>
                        <span id="db:s_201:val"></span><span class="text-muted"> (1)</span>
                      </div>
                      <div id="db:s_202:div" class="col" style="display: none;">
                        <span data-feather="thermometer" style="pointer-events: none;" class="align-text-bottom"></span>
                        <span id="db:s_202:val"></span><span class="text-muted"> (2)</span>
                      </div>
                      <div id="db:s_203:div" class="col" style="display: none;">
                        <span data-feather="thermometer" style="pointer-events: none;" class="align-text-bottom"></span>
                        <span id="db:s_203:val"></span><span class="text-muted"> (3)</span>
                      </div>


                    </div>
                    <!--./row-->
                  </div>


                  <div id="dashboard:alert">
                  </div>

                  <div class="card-body" id="chart_container">
                    <button id="dashboard:refresh" type="button" class="btn btn-primary d-none"
                      onclick="create_dashboard_chart()">
                      <span data-feather="refresh-cw" style="pointer-events: none;" class="align-text-bottom"></span>
                    </button>
                    <canvas class="my-4 w-100 chartjs-render-monitor" id="day_ahead_chart" width="1624" height="684"
                      style="display: block; height: 342px; width: 812px;"></canvas>
                  </div>

                  <!--./card-footer-->
                </div>
                <!--./card-->
              </div>
              <!--./col-->
            </div>
            <!--./row-->
            <div id="schedules" class="row row-cols-1 row-cols-md-2 g-4 mt-2">

            </div>
            <!--./row-->
          </div>
          <!--./dashboard-->
          <!-- Services removed
================================================== -->
          <!--./channels-->
          <!-- Channels
================================================== -->
          <div class="tab-pane fade" id="channels" role="tabpanel" aria-labelledby="channels-tab" tabindex="0">
            <div class="card white-card  mb-3" id="variables:card">
              <div class="card-header">
                <h5 class="card-title">Channel rules and definitions</h5>
              </div>
              <div class="card-body">
                <p>Channel states are calculated based on channel rules and current variable values.</p>
                <p>In template configuration mode select rule template and give required parameters. In advanced mode
                  you can enter the rules you want at a detailed level.</p>
                <p>The rules are checked in order, and the first rule whose conditions are met determines the state of
                  the channel.</p>

                <div class="accordion" id="variables_accordion">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="variables_accordionh3">
                      <button class="accordion-button" type="button" data-bs-toggle="collapse"
                        data-bs-target="#variables_acc" aria-expanded="true" aria-controls="variables_acc">
                        Variable descriptions and current values
                      </button>
                    </h2>
                    <div id="variables_acc" class="accordion-collapse collapsed collapse collapsed"
                      aria-labelledby="variables_accordionh3" data-bs-parent="#variables_accordion">
                      <div class="accordion-body">
                        <span id="vars_updated"></span>
                        <table id="tblVariables" class="table">
                          <thead>
                            <tr>
                              <th scope="col">#</th>
                              <th scope="col">Variable</th>
                              <th scope="col">Value</th>
                              <th scope="col">Description</th>
                            </tr>
                          </thead>
                          <tbody id="tblVariables_tb">
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>


              </div>
              <!--./card-body-->
              <div class="card-footer text-end">
                <!--./card-footer-->

              </div>
            </div>

            <div id="channels_row" class="row row-cols-1">
            </div>
            <!--./row-->
          </div>
          <!--./channels-->
          <!-- Admin / Settings
================================================== -->
          <div class="tab-pane fade" id="admin" role="tabpanel" aria-labelledby="admin-tab" tabindex="0">
            <div class="row row-cols-1 row-cols-md-2 g-4">

              <div class="col">
                <!-- Price data
                ================================================== -->
                <div class="card white-card mb-3" id="price_data:card">
                  <div class="card-header">
                    <h5 class="card-title">Price Data</h5>
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span class="text-muted">Nordpool price info is updated from ENTSO-E Transparency Platform. <a
                          target="_blank" href="https://github.com/Netgalleria/arska-node/wiki/Edit-Services">How to get
                          own ENTSO-E API
                          key</a></span>
                    </div>
                    <!--./chart-info-->
                  </div>
                  <!--./card-header-->
                  <div class="card-body">
                    <div class="mb-2">
                      <label for="entsoe_api_key" class="form-label">ENTSO-E API key</label>
                      <input type="url" class="form-control" id="entsoe_api_key"
                        placeholder="Enter API key sent by ENTSO-E">
                    </div>
                    <div class="mb-2">
                      <label for="entsoe_area_code" class="form-label">Area code</label>
                      <select id="entsoe_area_code" class="form-select" aria-label="variable">
                        <option value="#">not in use</option>
                        <option value="10YAT-APG------L">Austria, APG 🇦🇹</option>
                        <option value="10YBE----------2">Belgium, Elia 🇧🇪</option>
                        <option value="10YCA-BULGARIA-R">Bulgaria, ESO 🇧🇬</option>
                        <option value="10YHR-HEP------M">Croatia, HOPS 🇭🇷</option>
                        <option value="10YCZ-CEPS-----N">Czech Republic, CEPS 🇨🇿</option>
                        <option value="10Y1001A1001A82H">DE-LU 🇩🇪</option>
                        <option value="10YDK-1--------W">DK1 🇩🇰</option>
                        <option value="10YDK-2--------M">DK2 🇩🇰</option>
                        <option value="10Y1001A1001A39I">Estonia, Elering 🇪🇪</option>
                        <option value="10YFI-1--------U">Finland, Fingrid 🇫🇮</option>
                        <option value="10YFR-RTE------C">France, RTE 🇫🇷</option>
                        <option value="10YGR-HTSO-----Y">Greece, IPTO 🇬🇷</option>
                        <option value="10YHU-MAVIR----U">Hungary, MAVIR 🇭🇺</option>
                        <option value="10Y1001A1001A59C">Ireland (SEM) 🇮🇪</option>
                        <option value="10Y1001A1001A885">Italy_Saco_AC 🇮🇹</option>
                        <option value="10Y1001A1001A893">Italy_Saco_DC 🇮🇹</option>
                        <option value="10Y1001C--00096J">IT-Calabria 🇮🇹</option>
                        <option value="10Y1001A1001A70O">IT-Centre-North 🇮🇹</option>
                        <option value="10Y1001A1001A71M">IT-Centre-South 🇮🇹</option>
                        <option value="10Y1001A1001A73I">IT-North 🇮🇹</option>
                        <option value="10Y1001A1001A74G">IT-Sardinia 🇮🇹</option>
                        <option value="10Y1001A1001A75E">IT-Sicily 🇮🇹</option>
                        <option value="10Y1001A1001A788">IT-South 🇮🇹</option>
                        <option value="10YLV-1001A00074">Latvia, AST 🇱🇻</option>
                        <option value="10YLT-1001A0008Q">Lithuania, Litgrid 🇱🇹</option>
                        <option value="10YNL----------L">Netherlands, TenneT NL 🇳🇱</option>
                        <option value="10YNO-1--------2">NO1 🇳🇴</option>
                        <option value="10YNO-2--------T">NO2 🇳🇴</option>
                        <option value="10YNO-3--------J">NO3 🇳🇴</option>
                        <option value="10YNO-4--------9">NO4 🇳🇴</option>
                        <option value="10Y1001A1001A48H">NO5 🇳🇴</option>
                        <option value="50Y0JVU59B4JWQCU">NO2NSL 🇳🇴</option>
                        <option value="10YPL-AREA-----S">Poland, PSE SA 🇵🇱</option>
                        <option value="10YPT-REN------W">Portugal, REN 🇵🇹</option>
                        <option value="10YRO-TEL------P">Romania, Transelectrica 🇷🇴</option>
                        <option value="10Y1001A1001A44P">SE1 🇸🇪</option>
                        <option value="10Y1001A1001A45N">SE2 🇸🇪</option>
                        <option value="10Y1001A1001A46L">SE3 🇸🇪</option>
                        <option value="10Y1001A1001A47J">SE4 🇸🇪</option>
                        <option value="10YCS-SERBIATSOV">Serbia, EMS 🇷🇸</option>
                        <option value="10YSK-SEPS-----K">Slovakia, SEPS 🇸🇰</option>
                        <option value="10YSI-ELES-----O">Slovenia, ELES 🇸🇮</option>
                        <option value="10YES-REE------0">Spain, REE 🇪🇸</option>
                        <option value="10YCH-SWISSGRIDZ">Switzerland, Swissgrid 🇨🇭</option>
                      </select>
                    </div>
                    <div id="price_data:alert"></div>
                  </div>
                  <!--./card-body-->
                  <div class="card-footer text-end">
                    <button class="btn btn-primary" type="submit" id="price_data:save" disabled="">
                      <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                      Save</button>
                  </div>
                  <!--./card-footer-->
                </div><!-- price data-card-->
              </div>
              <!--./col-->
              <div class="col">
                <!-- Energy Forecast
                ================================================== -->
                <div class="card white-card mb-3" id="energy_forecast:card">
                  <div class="card-header">
                    <h5 class="card-title">Energy Forecast</h5>
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span class="text-muted"> FMI Energy forecast is currently only available in Finland.</span>
                    </div>
                    <!--./chart-info-->
                  </div>
                  <!--./card-header-->
                  <div class="card-body">
                    <div class="mb-2">
                      <label for="forecast_loc" class="form-label">Forecast location</label>
                      <select id="forecast_loc" class="form-select" aria-label="variable">
                        <option value="#">not in use</option>
                        <option value="634317">Akaa</option>
                        <option value="661576">Alajärvi</option>
                        <option value="661352">Alavus</option>
                        <option value="660158">Espoo</option>
                        <option value="659935">Forssa</option>
                        <option value="659681">Haapajärvi</option>
                        <option value="659554">Haapavesi</option>
                        <option value="659169">Hamina</option>
                        <option value="659101">Hanko</option>
                        <option value="658921">Harjavalta</option>
                        <option value="658288">Heinola</option>
                        <option value="658225">Helsinki</option>
                        <option value="658108">Hetta</option>
                        <option value="657180">Huittinen</option>
                        <option value="656913">Hyvinkää</option>
                        <option value="659180">Hämeenlinna</option>
                        <option value="656820">Iisalmi</option>
                        <option value="656789">Ikaalinen</option>
                        <option value="656688">Imatra</option>
                        <option value="656657">Inari</option>
                        <option value="655808">Joensuu</option>
                        <option value="655533">Juankoski</option>
                        <option value="655194">Jyväskylä</option>
                        <option value="656083">Jämsä</option>
                        <option value="655958">Järvenpää</option>
                        <option value="655130">Kaarina</option>
                        <option value="654899">Kajaani</option>
                        <option value="654837">Kalajoki</option>
                        <option value="654363">Kankaanpää</option>
                        <option value="654314">Kannus</option>
                        <option value="653960">Karkkila</option>
                        <option value="653758">Kaskinen</option>
                        <option value="653627">Kauhajoki</option>
                        <option value="653616">Kauhava</option>
                        <option value="653559">Kauniainen</option>
                        <option value="653281">Kemi</option>
                        <option value="653272">Kemijärvi</option>
                        <option value="653185">Kerava</option>
                        <option value="652977">Keuruu</option>
                        <option value="652793">Kilpisjärvi</option>
                        <option value="652615">Kitee</option>
                        <option value="652590">Kittilä</option>
                        <option value="652559">Kiuruvesi</option>
                        <option value="651980">Kokemäki</option>
                        <option value="651943">Kokkola</option>
                        <option value="650946">Kotka</option>
                        <option value="650859">Kouvola</option>
                        <option value="650769">Kristiinankaupunki</option>
                        <option value="650705">Kuhmo</option>
                        <option value="650224">Kuopio</option>
                        <option value="650095">Kurikka</option>
                        <option value="649360">Lahti</option>
                        <option value="649302">Laitila</option>
                        <option value="648900">Lappeenranta</option>
                        <option value="648855">Lapua</option>
                        <option value="648090">Lieksa</option>
                        <option value="647751">Lohja</option>
                        <option value="647731">Loimaa</option>
                        <option value="647571">Loviisa</option>
                        <option value="3041732">Mariehamn</option>
                        <option value="646005">Mikkeli</option>
                        <option value="645672">Muonio</option>
                        <option value="646705">Mänttä</option>
                        <option value="645211">Naantali</option>
                        <option value="644632">Nilsiä</option>
                        <option value="644499">Nivala</option>
                        <option value="644450">Nokia</option>
                        <option value="644187">Nurmes</option>
                        <option value="644100">Nykarleby</option>
                        <option value="645081">Närpes</option>
                        <option value="643644">Orimattila</option>
                        <option value="643629">Orivesi</option>
                        <option value="643497">Oulainen</option>
                        <option value="643492">Oulu</option>
                        <option value="643453">Outokumpu</option>
                        <option value="643153">Paimio</option>
                        <option value="642673">Parainen</option>
                        <option value="642657">Parkano</option>
                        <option value="642367">Pello</option>
                        <option value="641869">Pieksämäki</option>
                        <option value="656130">Pietarsaari</option>
                        <option value="640999">Pori</option>
                        <option value="660561">Porvoo</option>
                        <option value="640803">Pudasjärvi</option>
                        <option value="640441">Pyhäjärvi</option>
                        <option value="640276">Raahe</option>
                        <option value="640124">Raisio</option>
                        <option value="639853">Raseborg</option>
                        <option value="639734">Rauma</option>
                        <option value="639406">Riihimäki</option>
                        <option value="638936">Rovaniemi</option>
                        <option value="638321">Saarijärvi</option>
                        <option value="-10017507">Saariselkä</option>
                        <option value="-10000380">Salla</option>
                        <option value="637948">Salo</option>
                        <option value="-16011686">Sastamala</option>
                        <option value="637292">Savonlinna</option>
                        <option value="637219">Seinäjoki</option>
                        <option value="636464">Sodankylä</option>
                        <option value="636345">Somero</option>
                        <option value="635692">Suonenjoki</option>
                        <option value="634963">Tampere</option>
                        <option value="634093">Tornio</option>
                        <option value="633679">Turku</option>
                        <option value="633395">Ulvila</option>
                        <option value="633268">Utsjoki</option>
                        <option value="633221">Uusikaupunki</option>
                        <option value="632978">Vaasa</option>
                        <option value="632672">Valkeakoski</option>
                        <option value="632453">Vantaa</option>
                        <option value="632370">Varkaus</option>
                        <option value="631560">Viitasaari</option>
                        <option value="631459">Vilppula</option>
                        <option value="631376">Virrat</option>
                        <option value="630768">Ylivieska</option>
                        <option value="630752">Ylöjärvi</option>
                        <option value="661896">Ähtäri</option>
                        <option value="662095">Äänekoski</option>
                      </select>

                    </div>
                    <div class="mb-2">
                      <label for="pv_power" class="form-label">Panel peak power (W)</label>
                      <input type="number" min="0" class="form-control" id="pv_power" placeholder="0">
                    </div>
                    <div class="mb-2">
                      <label for="baseload" class="form-label">Daytime baseload (W)</label>
                      <input type="number" class="form-control" id="baseload" placeholder="0">
                    </div>
                    <div id="energy_forecast:alert"></div>
                  </div>
                  <!--./card-body-->
                  <div class="card-footer text-end">
                    <button class="btn btn-primary" type="submit" id="energy_forecast:save" disabled="">
                      <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                      Save</button>
                  </div>
                  <!--./card-footer-->
                </div><!-- energy_forecast -card-->
              </div>
              <!--./col-->
              <div class="col">
                <!-- Energy metering
                ================================================== -->
                <div class="card white-card  mb-3" id="metering:card">
                  <div class="card-header">
                    <h5 class="card-title">Grid Energy Metering</h5>
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span class="text-muted">Optional grid metering helps in optimizing the use of self-produced
                        electricity.</span>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="mb-2">
                      <label for="energy_meter_type" class="form-label">Energy Meter Type</label>
                      <select id="energy_meter_type" class="form-select" aria-label="variable">
                        <option value="0">not in use</option>
                        <option value="1">Shelly 3 EM</option>
                        <option value="4">HAN P1 Telegram / Wifi</option>
                      </select>
                    </div>
                    <div class="mb-2">
                      <label for="energy_meter_ip" class="form-label">Energy Meter IP Address</label>
                      <input type="text" class="form-control" id="energy_meter_ip" placeholder=""
                        pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}$">
                    </div>
                    <div class="mb-2">
                      <label for="energy_meter_port" class="form-label">Energy Meter IP Port</label>
                      <input type="number" class="form-control" id="energy_meter_port" placeholder="Typically 80"
                        min="1" step="1" max="65536">
                    </div>
                    <div class="mb-2">
                      <label for="energy_meter_password" class="form-label">Energy Meter Password</label>
                      <input type="text" class="form-control" id="energy_meter_password">
                    </div>
                    <div id="metering:alert"></div>
                  </div>
                  <!--./card-body-->
                  <div class="card-footer text-end">
                    <button class="btn btn-primary" type="submit" id="metering:save" disabled="">
                      <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                      Save</button>
                  </div>
                  <!--./card-footer-->
                </div><!-- metering card-->
              </div>
              <!--./col-->
              <div class="col">
                <!-- Energy production
                ================================================== -->
                <div class="card white-card  mb-3" id="production:card">
                  <div class="card-header">
                    <h5 class="card-title">Energy Production Metering</h5>
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span class="text-muted">Optional production metering reads your solar inverter.</span>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="mb-2">
                      <label for="production_meter_type" class="form-label">Inverter Type</label>
                      <select id="production_meter_type" class="form-select" aria-label="variable">
                        <option value="0">not in use</option>
                        <option value='1'>Fronius Solar API</option>
                        <option value='2'>SMA Modbus TCP</option>
                      </select>
                    </div>
                    <div class="mb-2">
                      <label for="production_meter_ip" class="form-label">Inverter IP Address</label>
                      <input type="text" class="form-control" id="production_meter_ip" placeholder="0.0.0.0">
                    </div>
                    <div class="mb-2">
                      <label for="production_meter_port" class="form-label">Inverter IP Port</label>
                      <input type="number" class="form-control" id="production_meter_port"
                        placeholder="defaults 80 for Fronius503 for SMA">
                    </div>
                    <div class="mb-2">
                      <label for="production_meter_id" class="form-label">Inverter IP ID</label>
                      <input type="number" class="form-control" id="production_meter_id" placeholder="SMA default 3"
                        min="0" step="1" max="255">
                    </div>

                    <div id="production:alert"></div>
                  </div>
                  <!--./card-body-->
                  <div class="card-footer text-end">
                    <button class="btn btn-primary" type="submit" id="production:save" disabled="">
                      <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                      Save</button>
                  </div>
                  <!--./card-footer-->
                </div><!-- production card-->
              </div>
              <!--./col-->
              <div class="col">
                <!-- Influx Server
               ================================================== -->
                <div class="card white-card  mb-3" id="influx:card">
                  <div class="card-header">
                    <h5 class="card-title">Influx Server</h5>
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span class="text-muted">Define optional server for history time series reporting and
                        analysis.</span>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="mb-2">
                      <label for="influx_url" class="form-label">URL</label>
                      <input type="url" class="form-control" id="influx_url" placeholder="">
                    </div>
                    <div class="mb-2">
                      <label for="influx_token" class="form-label">Token</label>
                      <input type="text" class="form-control" id="influx_token" placeholder="">
                    </div>
                    <div class="mb-2">
                      <label for="influx_org" class="form-label">Organization</label>
                      <input type="text" class="form-control" id="influx_org"
                        placeholder="Typically your email address">
                    </div>
                    <div class="mb-3">
                      <label for="influx_bucket" class="form-label">Bucket</label>
                      <input type="text" class="form-control" id="influx_bucket" placeholder="">
                    </div>
                    <div id="influx:alert"></div>
                  </div>
                  <!--./card-body-->
                  <div class="card-footer text-end">
                    <!--  <button class="btn btn-primary" id="influx:test"> 
                     <span data-feather="type" style="pointer-events: none;" class="align-text-bottom"></span>
                     Test</button> -->
                    <button class="btn btn-primary" type="submit" id="influx:save" disabled="">
                      <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                      Save</button>
                  </div>
                  <!--./card-footer-->

                </div><!-- influx card-->
              </div>
              <!--./col-->
              <div class="col">
                <!-- Localisation 
               ================================================== -->
                <div class="card white-card  mb-3" id="local:card">
                  <div class="card-header">
                    <h5 class="card-title">Localisation</h5>
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span class="text-muted">Local options.</span>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="mb-2">
                      <label for="timezone" class="form-label">Timezone</label>
                      <select id="timezone" class="form-select" aria-label="variable">
                        <option value="EET">EET</option>
                        <option value="CET">CET</option>
                      </select>

                    </div>
                    <div class="mb-2">
                      <label for="lang" class="form-label">Preferred language</label>
                      <select id="lang" class="form-select" aria-label="variable">
                        <option value="en">English</option>
                        <option value="fi">Suomi (vain sääntöpohjat ja muuttujat)</option>
                      </select>
                    </div>

                    <div id="local:alert"></div>
                  </div>
                  <!--./card-body-->
                  <div class="card-footer text-end">

                    <button class="btn btn-primary" type="submit" id="local:save" disabled="">
                      <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                      Save</button>
                  </div>
                  <!--./card-footer-->

                </div><!-- influx card-->
              </div>
              <!--./col-->
              <div class="col">
                <!-- Wifi & network
             ================================================== -->
                <div class="card white-card  mb-3" id="network:card">
                  <div class="card-header">
                    <h5 id="network:title" class="card-title">Network</h5>
                    <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                      <span class="text-muted">Wifi and administration password settings.</span>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="mb-2">
                      <label for="wifi_ssid" class="form-label">SSID</label>
                      <div class="input-group mb-0">
                        <input type="text" class="form-control" id="wifi_ssid" placeholder="" list="wifi_ssid_list">
                        <button id="network:refresh" type="button" class="btn btn-primary"
                          onclick="populate_wifi_ssid_list()">
                          <span data-feather="refresh-cw" style="pointer-events: none;"
                            class="align-text-bottom"></span>
                        </button>
                        <datalist id="wifi_ssid_list">
                        </datalist>
                      </div>
                    </div>
                    <div class="mb-2">
                      <label for="wifi_password" class="form-label">Password</label>
                      <div class="input-group mb-0">
                        <input type="password" class="form-control" id="wifi_password" placeholder="">
                        <button id="wifi_password_show" type="button" class="btn btn-primary"
                          onclick="toggle_show(this);"><span data-feather="eye" style="pointer-events: none;"
                            class="align-text-bottom"></span></button>

                        <button id="wifi_password_hide" type="button" class="btn btn-primary d-none"
                          onclick="toggle_show(this);"> <span data-feather="eye-off" style="pointer-events: none;"
                            class="align-text-bottom"></span>
                        </button>
                      </div>
                    </div>
                    <div id="password_note"></div>
                    <div class="mb-2">
                      <label for="http_password" class="form-label">Password for 'admin'</label>
                      <input type="password" class="form-control" id="http_password" placeholder="">
                    </div>
                    <div class="mb-2">
                      <label for="http_password2" class="form-label">Rewrite 'admin' password to change</label>
                      <input type="password" class="form-control" id="http_password2" placeholder="">
                    </div>

                    <div id="network:alert"></div>
                  </div>
                  <!--./card-body-->
                  <div class="card-footer text-end">

                    <button class="btn btn-primary" type="submit" id="network:save" disabled="">
                      <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                      Save</button>
                  </div>
                  <!--./card-footer-->

                </div><!-- network-->
              </div>
              <!--./col-->

              <div class="col">
                <!-- Admin actions
            ================================================== -->
                <div class="card white-card mb-3" id="admin:card">
                  <div class="card-header">
                    <div class="card-header">
                      <h5 class="card-title">System administration</h5>
                      <div class="chart-info d-flex align-items-center mt-2 mt-xl-0">
                        <span class="text-muted">Always backup configuration before system upgrade.</span>
                      </div>
                    </div>

                  </div>
                  <!--./card-header-->
                  <div class="card-body">
                    <div class="mb-2">
                      <label class="form-label">Backup configuration</label>
                      <br>
                      <a href="/settings?format=file"><button class="btn btn-primary"
                          style="line-height:1.1;width:140px;" type="submit" id="do_backup">
                          <span data-feather="download" style="pointer-events: none;" class="align-text-bottom"></span>
                          Backup</button></a>
                    </div>

                    <div class="mb-2">
                      <label class="form-label">Restore configuration</label>
                      <form id="restore_form" method="post" enctype="multipart/form-data" style="display: inline;">

                        <div class="input-group">

                          <div class="custom-file">
                            <input type="file" class="custom-file-input" id="restore_config_btn"
                              aria-describedby="restore_config_btn" accept='application/json'
                              onchange='restore_config(event)'>
                          </div>
                        </div>

                      </form>
                    </div>
                    <br>
                    <div class="mb-2">
                      <label class="form-label">Current version</label>
                      <table id="version_table" class="table">
                        <tbody>
                          <tr>
                            <td scope="col">Software</td>
                            <th id="version" scope="row"></th>
                          </tr>
                          <tr>
                            <td scope="col">Filesystem</td>
                            <th id="version_fs" id_scope="row"></th>
                          </tr>

                          <tr>
                            <td scope="col">System started</td>
                            <th id="started_str" id_scope="row"></th>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <div class="mb-2">
                      <label for="sel_releases" class="form-label">Upgrade</label>
                      <div class="input-group mb-0">

                        <button id="releases:refresh" type="button" class="btn btn-primary"
                          onclick="populate_releases()" data-bs-toggle="tooltip" data-bs-custom-class="custom-tooltip"
                          data-bs-placement="top" data-bs-title="Get available firmware versions">
                          <span data-feather="refresh-ccw" style="pointer-events: none;"
                            class="align-text-bottom"></span>
                        </button>
                        <select id="sel_releases" class="form-select" aria-label="variable" disabled="">
                          <option value="#">Refresh versions</option>
                        </select>
                        <button id="releases:update" type="button" class="btn btn-primary" onclick="start_fw_update();"
                          disabled="" data-bs-toggle="tooltip" data-bs-custom-class="custom-tooltip"
                          data-bs-title="Start upgrade">
                          <span data-feather="download-cloud" style="pointer-events: none;"
                            class="align-text-bottom"></span> Upgrade</button>
                      </div>
                    </div>

                    <div class="accordion" id="adminadv_accordion">
                      <div class="accordion-item">
                        <h2 class="accordion-header" id="adminadv_accordionh3">
                          <button class="accordion-button" type="button" data-bs-toggle="collapse"
                            data-bs-target="#adminadv_acc" aria-expanded="true" aria-controls="adminadv_acc">
                            Advanced settings
                          </button>
                        </h2>
                        <div id="adminadv_acc" class="accordion-collapse collapsed collapse collapsed"
                          aria-labelledby="adminadv_accordionh3" data-bs-parent="#adminadv_accordion">
                          <div class="accordion-body">
                            <div class="d-grid gap-2 d-md-block text-end">
                              <label class="form-label">Special actions</label><br>

                              <button type="button" id="admin:restart" class="btn btn-secondary">Restart and clear
                                cache</button>
                              <button type="button" id="admin:reset" class="btn btn-secondary">Reset Settings</button>
                              <button type="button" id="admin:scan_sensors" class="btn btn-secondary">Scan
                                Sensors</button>
                            </div>
                            <div class="mb-2">
                              <label for="hw_template_id" class="form-label">Hardware template</label>
                              <select id="hw_template_id" class="form-select" aria-label="variable">
                                <option value="0">undefined</option>
                                <option value="1">esp32lilygo-4ch</option>
                                <option value="2">esp32wroom-4ch-a</option>
                                <option value="3">devantech-esp32lr42</option>
                              </select>
                            </div>
                            <div class="mb-2">
                              <a href="/update">Manual upgrade</a>
                            </div>

                            <div id="admin:alert"></div>


                            <button class="btn btn-primary" type="submit" id="admin:save" disabled="">
                              <span data-feather="save" style="pointer-events: none;" class="align-text-bottom"></span>
                              Save</button>

                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="card-footer text-end d-none">
                  </div><!-- card footer-->
                </div><!-- actions card-->

              </div>
              <!--./col-->

              <div class="col">
                <!-- Licenses
                ================================================== -->
                <div class="card white-card  mb-3" id="metering:card">
                  <div class="card-header">
                    <h5 class="card-title">Data sources and licenses</h5>

                  </div>
                  <div class="card-body">
                    <label for="production_meter_type" class="form-label">Data sources:</label>
                    <p>Day-ahead prices <a
                        href="https://transparency.entsoe.eu/"">ENTSO-E Transparency Platform</a>, FMI Energy weather (Finland only) <a href="
                        https://www.ilmatieteenlaitos.fi/aurinko-ja-tuulivoimaennuste">FMI</a></p>

                    <label for="production_meter_type" class="form-label">Open source licenses:</label>
                    <p>
                      <a href="https://github.com/jquery/jquery">JQuery</a>, <a
                        href="https://github.com/me-no-dev/ESPAsyncWebServer">ESPAsyncWebServer</a>, <a
                        href="https://github.com/bblanchon/ArduinoJson" target="wiki">ArduinoJson</a>, NTPClient, <a
                        target="wiki" href="https://github.com/emelianov/modbus-esp8266">modbus-esp8266</a>,
                      adafruit/RTClib, SPI,
                      <a href="https://github.com/tobiasschuerg/InfluxDB-Client-for-Arduino"
                        target="wiki">tobiasschuerg/ESP8266 Influxdb</a>, <a
                        href="https://github.com/milesburton/Arduino-Temperature-Control-Library">DallasTemperature</a>,
                      <a href="https://github.com/PaulStoffregen/OneWire">paulstoffregen/OneWire</a>,
                      <a href="https://github.com/marian-craciunescu/ESP32Ping">ESP32Ping</a> , <a
                        href="https://github.com/chartjs/Chart.js" target="wiki">Chart.js</a>
                    </p>

                    <p>Arska (C) Netgalleria Oy, Olli Rinne, 2021-2023</p>

                  </div>
                  <!--./card-body-->

                  <!--./card-footer-->
                </div><!-- licence card-->
              </div>


            </div>
            <!--./row-->
          </div>
          <!--./admin-->
        </div>
        <!--tab-content-->

      </main>

    </div>
    <!--./container-xl-->
  </div>
  <!--./row-->


  <!--color picker vaatii popper scriptin mukaan-->
  <!--
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
    crossorigin="anonymous"></script>
    -->
  <script defer src="/js/bootstrap.bundle.min.js"></script>
  <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  
  <script defer src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"
    integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE"
    crossorigin="anonymous"></script>
    -->

  <script defer src="/js/feather.min.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
    integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha"
    crossorigin="anonymous"></script> -->


  <!--tooltip-->
  <!--
  <script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
  </script>
  -->
</body>

</html>